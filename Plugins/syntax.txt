Plugins use an ActiveX interface.
Plugins may be written in any format that supports this interface. Examples are available in :
	C++ COM component
	VB ActiveX dll
	scriptlets (VBS,JS)
	Delphi

Limitation : scriptlets only work for EDITOR_SCRIPT plugins.
The plugins code is being rewritten, and in the next version, scriptlet will work for any event.


Properties syntax
=================
				
PluginEvent
C++	STDMETHODIMP CWinMergeScript::get_PluginEvent(BSTR * pVal)
VB	Public Property Get PluginEvent() As String
VBS	Function get_PluginEvent()

PluginDescription
C++	STDMETHODIMP CWinMergeScript::get_PluginDescription(BSTR * pVal)
VB	Public Property Get PluginDescription() As String
VBS	Function get_PluginDescription()

PluginFileFilters
String formed of fileFilters, separated with ";"
C++	STDMETHODIMP CWinMergeScript::get_PluginFileFilters(BSTR * pVal)
VB	Public Property Get PluginFileFilters() As String

PluginIsAutomatic
C++	STDMETHODIMP CWinMergeScript::get_PluginIsAutomatic(VARIANT_BOOL * pVal)
VB	Public Property Get PluginIsAutomatic() As Boolean



Methods syntax
==============
EDITOR_SCRIPT		Functions parameters (function names are free) :
			C++	STDMETHOD(MakeUpperVB)([in] BSTR inputText, [out, retval] BSTR * outputText);
			VB	Public Function MakeUpperVB(text As String)
			VBS	Function MakeUpperVBS(Text)

FILE_PREDIFF		Functions names and parameters : 
			VC++	STDMETHOD(PrediffFile)        ([in] BSTR fileSrc, [in] BSTR fileDst, VARIANT_BOOL * pbChanged, INT * pSubcode, [out, retval] VARIANT_BOOL * pbSuccess)
			VB	Public Function PrediffFile   (BSTR fileSrc, BSTR fileDst, ByRef bChanged As Boolean, ByRef subcode As Long) As Boolean

BUFFER_PREDIFF		Functions names and parameters : 
			C++ 	STDMETHOD(PrediffBufferW)     ([in] BSTR * pText, [in] INT * pSize, [in] VARIANT_BOOL * pbChanged, [out, retval] VARIANT_BOOL * pbHandled);
			VB	Public Function PrediffBufferW(ByRef text As String, ByRef size As Long, ByRef bChanged As Boolean) As Boolean

FILE_PACK_UNPACK	Functions names and parameters : 
			VC++	STDMETHOD(UnpackFile)         ([in] BSTR fileSrc, [in] BSTR fileDst, VARIANT_BOOL * pbChanged, INT * pSubcode, [out, retval] VARIANT_BOOL * pbSuccess)
				STDMETHOD(PackFile)           ([in] BSTR fileSrc, [in] BSTR fileDst, VARIANT_BOOL * pbChanged, INT pSubcode, [out, retval] VARIANT_BOOL * pbSuccess)
			VB	Public Function UnpackFile    (BSTR fileSrc, BSTR fileDst, ByRef bChanged As Boolean, ByRef subcode As Long) As Boolean
				Public Function PackFile      (BSTR fileSrc, BSTR fileDst, ByRef bChanged As Boolean, subcode As Long) As Boolean

BUFFER_PACK_UNPACK	Functions names and parameters : 
			VC++	STDMETHOD(UnpackBufferA)      ([in] SAFEARRAY ** pBuffer, [in] INT * pSize, [in] VARIANT_BOOL * pbChanged, [in] INT * pSubcode, [out, retval] VARIANT_BOOL * pbSuccess)
				STDMETHOD(PackBufferA)        ([in] SAFEARRAY ** pBuffer, [in] INT * pSize, [in] VARIANT_BOOL * pbChanged, [in] INT subcode, [out, retval] VARIANT_BOOL * pbSuccess)
			VB	Public Function UnpackBufferA (ByRef buffer() As Byte, ByRef size As Long, ByRef bChanged As Boolean, ByRef subcode As Long) As Boolean
				Public Function PackBufferA   (ByRef buffer() As Byte, ByRef size As Long, ByRef bChanged As Boolean, subcode As Long) As Boolean


Additionnal steps to write a plugin in C++
==========================================

* do not register the dll : delete everything in 'settings'->'custom build'
* do not register the dll : delete the file .rgs, and the registry section in the file .rc
* do not register the dll : add typeinfoex.h + and make 3 changes in WinMergeScript.h (see commented lines)
* SAFEARRAY : replace the interface in .idl :
	SAFEARRAY * 		SAFEARRAY(unsigned char)
	SAFEARRAY ** 		SAFEARRAY(unsigned char) *

